@model GreenLightSharp.Models.Display

@{
    ViewBag.Title = "ShowPage";
    string modelJSON = Model.Member.Id;
}

@functions{
    public static string statusColor(string status) { return status == "0" ? "/Content/red32.png" : "/Content/green32.png"; }
}

<h2>ShowPage</h2>
<h4>Display</h4>
<hr />
<div class="col-md-4">
    <b>@Model.Member.Name</b>
    <div id="memStat"><img src=@statusColor(Model.Member.Status)></div>

</div>
<div class="col-md-4">
    <ul>
        @foreach (var member in Model.Show.Members)
        {
            <li>
                <b>@member.Name</b> - <b><img src=@statusColor(member.Status) height="10" width="10" /></b>
            </li>
        }
    </ul>
</div>
@if (Model.Show.ShowStatus == "1")
{
    <div class="col-md-4">
        @Html.Partial("Success")
    </div>
}


@section Scripts {

    <script type="text/javascript">
        
        $("#memStat").click(function () {
            $.ajax({
                type: "POST",
                url: '@Url.Action("PatchMember", "Home")',
                data: "{ 'id': '@Model.Member.Id', 'bid': '@Model.Show.Id'}" ,
                contentType: "application/json; charset=utf-8",
                dataType: "html",
                success: function () {
                    location.reload();
                }
            });
        });
        //refresh
        setTimeout(function () {
            //var Url = '/Home/ShowPage/@Model.Member.Id?bid=@Model.Show.Id';
            //var showUrl = encodeURI(Url);
            //$.ajax({
            //    type: "GET",
            //    url: showUrl,
            //    contentType: "application/json; charset=utf-8",
            //    dataType: "html",
            //    success: function (data) { }
                location.reload();
            //});
        }, 5000);
        $("#reset").click(function() {
            $.ajax({
                type: "POST",
                url: '@Url.Action("Clear", "Home")',
                data: "{ 'bid': '@Model.Show.Id'}",
                contentType: "application/json; charset=utf-8",
                dataType: "html"
            });
            $("#reset").attr("src", "/Content/red32.png");
        });
    </script>
    
}